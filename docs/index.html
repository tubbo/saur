<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | saur</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/tubbo/saur"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application.js~Application.html">Application</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/controller.js~Controller.html">Controller</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/mailer.js~Mailer.html">Mailer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model.js~Model.html">Model</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/routes.js~Routes.html">Routes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/task.js~Task.html">Task</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/view.js~View.html">View</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validate">validate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validates">validates</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-task">task</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-describe">describe</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#application">application</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/adapter.js~Adapter.html">Adapter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/cache.js~Cache.html">Cache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/cache.js~MemoryCache.html">MemoryCache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/cache.js~RedisCache.html">RedisCache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/database.js~Database.html">Database</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/database.js~MysqlAdapter.html">MysqlAdapter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/application/database.js~PostgresAdapter.html">PostgresAdapter</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#application-initializers">application/initializers</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Assets">Assets</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EnvironmentConfig">EnvironmentConfig</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ForceSSL">ForceSSL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Logging">Logging</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServeStaticFiles">ServeStaticFiles</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#application-middleware">application/middleware</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AuthenticityToken">AuthenticityToken</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CompileAssets">CompileAssets</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ContentSecurityPolicy">ContentSecurityPolicy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CORS">CORS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-logger">logger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MethodOverride">MethodOverride</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MissingRoute">MissingRoute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-OakCache">OakCache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SSLRedirect">SSLRedirect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-StaticFiles">StaticFiles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-timing">timing</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cli">cli</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Generate">Generate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Migrate">Migrate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-New">New</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Run">Run</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#cli-generate">cli/generate</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-controller">controller</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mailer">mailer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-migration">migration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-model">model</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-GenerateTemplate">GenerateTemplate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Test">Test</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-GenerateView">GenerateView</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#errors">errors</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/errors/missing-route.js~MissingRouteError.html">MissingRouteError</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#model">model</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/errors.js~Errors.html">Errors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/migration.js~Migration.html">Migration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/relation.js~Relation.html">Relation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/validations.js~GenericValidation.html">GenericValidation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/validations.js~Presence.html">Presence</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/model/validations.js~Validation.html">Validation</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#routes">routes</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/routes/helpers.js~RouteHelpers.html">RouteHelpers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/routes/route-set.js~RouteSet.html">RouteSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/routes/route.js~Route.html">Route</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#view">view</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/saur/view/template.js~Template.html">Template</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="deno-saur">Deno Saur</h1><p>A rapid development web framework for <a href="https://deno.land">deno</a>.</p>
<h2 id="features">Features</h2><ul>
<li>Model-View-Controller Architecture</li>
<li>Supports multiple SQL database backends</li>
<li>Built-in caching</li>
<li>Routing DSL</li>
</ul>
<h2 id="installation">Installation</h2><p>Install the CLI with <code>deno install</code>:</p>
<pre><code><code class="source-code prettyprint">deno install --allow-run --allow-write saur https://deno.land/x/saur/cli.js</code>
</code></pre><p>Then create your app using the <code>new</code> command:</p>
<pre><code><code class="source-code prettyprint">saur new my-app
cd my-app</code>
</code></pre><p>You&apos;ll get an <strong>index.js</strong> file to start out.</p>
<p>Generate code by running the <code>generate</code> command:</p>
<pre><code><code class="source-code prettyprint">saur generate controller home</code>
</code></pre><p>And start the server by running:</p>
<pre><code><code class="source-code prettyprint">saur server</code>
</code></pre><p>You can also run tests:</p>
<pre><code><code class="source-code prettyprint">deno test</code>
</code></pre><h2 id="usage">Usage</h2><p>Saur is strucutured similarly to other &quot;Web MVC&quot; frameworks like
<a href="https://djangoproject.com">Django</a> and <a href="https://rubyonrails.org">Ruby on Rails</a>. Each object in your application
represents a different role that&apos;s played:</p>
<ul>
<li><strong>Controllers</strong> are used to respond to requests from the main
application router. After parsing the URL, a new instance of the
Controller is created to fulfill the request. Controllers come
pre-packed with abstractions meant to help you in this effort.</li>
<li><strong>Models</strong> encapsulate the database logic with an Object-Relational
Mapper, pre-populating your model objects with the data from the
database and validating input before it&apos;s persisted.</li>
<li><strong>Views</strong> are objects used to render templates within a given context.
Similar to helpers and presenters in Rails, you can define View
methods and have them automatically appear in the rendered template.</li>
<li><strong>Templates</strong> are [EJS][] files that live in <code>./templates</code>, and
populated with a <code>View</code> object as context when they are rendered from
file.</li>
</ul>
<h3 id="quick-start--hello-world">Quick Start: Hello World</h3><p>Create a new application:</p>
<pre><code><code class="source-code prettyprint">saur new hello
cd hello</code>
</code></pre><p>Generate the controller and action:</p>
<pre><code><code class="source-code prettyprint">saur generate application index</code>
</code></pre><p>Edit <strong>templates/application/hello.html.ejs</strong>:</p>
<pre><code class="lang-html"><code class="source-code prettyprint">&lt;h1&gt;hello world&lt;/h1&gt;</code>
</code></pre>
<p>Open <strong>index.js</strong> and add your route:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import Application from &quot;https://deno.land/x/saur/application.js&quot;
import ApplicationController from &quot;./controllers/application&quot;

const App = new Application({
  // enter your config settings here
})

App.routes.draw(({ root }) =&gt; {
  root(&quot;index&quot;, ApplicationController)
})

export default App</code>
</code></pre>
<p>Start the server, and browse to <a href="http://localhost:3000">http://localhost:3000</a></p>
<pre><code><code class="source-code prettyprint">saur server</code>
</code></pre><p>You should see a big ol&apos; &quot;Hello World!&quot;</p>
<h3 id="models">Models</h3><p>Models are structured very similar to ActiveRecord. Here&apos;s an example of
what a <code>User</code> model might look like:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import Model, { validates, validate } from &quot;https://deno.land/x/saur/model.js&quot;

export default class User extends Model {
  static table = &quot;users&quot;
  static validations = [
    validates(&quot;name&quot;, { presence: true })
    validates(&quot;password&quot;, { presence: true })
    validate(&quot;nameNotFoo&quot;)
  ]

  nameNotFoo() {
    if (this.name === &quot;foo&quot;) {
      this.errors.add(&quot;name&quot;, &quot;cannot be &apos;foo&apos;&quot;)
    }
  }
}</code>
</code></pre>
<p>You can find a model by its ID like so;</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">const user = User.find(1)</code>
</code></pre>
<p>Or, find it by any other property:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">const userByName = User.findBy({ name: &quot;bar&quot; })</code>
</code></pre>
<p>Using <a href="https://github.com/manyuanrong/sql-builder">SQL Builder</a> under the hood, you can chain query fragments
together to construct a query based on the given data. Saur wraps the
SQL Builder&apos;s <code>Query</code> object, lazy-loading the data you need when you
ask for it. For example, the following query won&apos;t be run immediately:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">const users = User.where({ name: &quot;bar&quot; })

users.limit(10)</code>
</code></pre>
<p>Only when the data is actually needed, like iteration methods, will it be run:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">const names = users.map(user =&gt; user.name) // =&gt; [&quot;bar&quot;]</code>
</code></pre>
<p>This doesn&apos;t apply for <code>find</code> or <code>findBy</code>, since those need to return a
full model object, and thus the query will run when called in order to
give you immediate feedback.</p>
<h3 id="controllers">Controllers</h3><p>The controller layer is used for parsing requests and rendering
responses. It&apos;s the abstraction between the router/server and your
application code. Controllers are primarily used to query the database
and render Views to display that data in a certain way, depending on the
requested format.</p>
<p>Here&apos;s what a controller for the <code>User</code> model might look like:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import Controller from &quot;https://deno.land/x/saur/controlller.js&quot;;
import UserView from &quot;../views/user.js&quot;;

export default UsersController extends Controller {
  show({ id }) {
    const user = User.find(id);

    this.render(UserView, { user });
  }
}</code>
</code></pre>
<h3 id="views-and-templates">Views and Templates</h3><p>View objects are used to encapsulate template rendering and data
presentation. Separating the concerns of the &quot;presentation&quot; and &quot;data&quot;
layers, Views take the form of a &quot;presenter&quot; from other applications,
but are coupled to a particular template that it is responsible for
rendering. As such, a view will need to be made alongside a
corresponding template for each response you wish to create. Here&apos;s an
example of what the <code>UserView</code> might look like from before:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import View from &quot;https://deno.land/x/saur/view.js&quot;;

export default UserView extends View {
  static template = &quot;user.ejs&quot;;

  get title() {
    const { user: { name } } = this.context

    return `@${name}&apos;s Profile`
  }
}</code>
</code></pre>
<p>And your <code>user.ejs</code> template:</p>
<pre><code class="lang-html"><code class="source-code prettyprint">&lt;article class=&quot;user&quot;&gt;
  &lt;header&gt;
    &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt;
  &lt;/header&gt;
&lt;/article&gt;</code>
</code></pre>
<p>Although views need a template in order to render, templates can be
reused between views given the right kind of context. The markup in
<code>user.ejs</code>, for example, can be reused by another template like
<code>users.ejs</code> when it comes time to render a partial:</p>
<pre><code class="lang-html"><code class="source-code prettyprint">&lt;ul class=&quot;users&quot;&gt;
&lt;% users.forEach(user =&gt; { %&gt;
  &lt;li&gt;&lt;%= include(&quot;user.ejs&quot;, { user, title: user.name }) %&gt;&lt;/li&gt;
&lt;% }) %&gt;
&lt;/ul&gt;</code>
</code></pre>
<p>The partial is rendered without the <code>UserView</code> context. To supply a
different view context, you can also render the partial from the view
class itself:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import View from &quot;https://deno.land/x/saur/view.js&quot;;

export default UsersView extends View {
  static template = &quot;users.ejs&quot;;

  get users() {
    return this.context.users.map(user =&gt; this.render(UserView, { user })
  }

  get title() {
    const { user: { name } } = this.context

    return `@${name}&apos;s Profile`
  }
}</code>
</code></pre>
<p>The template can be cleaned up like so:</p>
<pre><code class="lang-html"><code class="source-code prettyprint">&lt;ul class=&quot;users&quot;&gt;
  &lt;%= users %&gt;
&lt;/ul&gt;</code>
</code></pre>
<p>Additionally, views are not coupled to controllers. They can be used in
mailers as well:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">import Mailer from &quot;https://deno.land/x/saur/mailer.js&quot;

export default class UserMailer extends Mailer {
  confirmation(user) {
    const title = &quot;Click here to confirm your account&quot;
    this.render(UserView, { user })
  }
}</code>
</code></pre>
<h3 id="caching">Caching</h3><p>A caching layer is also built in, with support for &quot;russian-doll&quot;
strategies in the view:</p>
<pre><code><code class="source-code prettyprint">&lt;article&gt;
  &lt;%= cache(`users/${user.id}`, () =&gt; { %&gt;
    &lt;header&gt;
      &lt;h1&gt;&lt;%= user.name %&gt;&lt;/h1&gt;
    &lt;/header&gt;
    &lt;main&gt;
      &lt;%= cache(`users/${user.id}/posts`, () =&gt; { %&gt;
        &lt;% user.posts.forEach(post =&gt; { %&gt;
          &lt;p&gt;&lt;%= post.title %&gt;&lt;/p&gt;
        &lt;% }) %&gt;
      &lt;%= }) %&gt;
    &lt;/main&gt;
  &lt;%= }) %&gt;
&lt;/article&gt;</code>
</code></pre><p>This <code>cache</code> method is provided in the <code>View</code> for your convenience, but
you can access the app cache directly using <code>App.cache</code>. The method used
in the <code>cache</code> helper is <code>App.cache.fetch</code>, and is notable because it
first checks if a key is available and uses the cache if so, otherwise
it will call the provided &quot;fresh&quot; method and save that value as the
cache.</p>
<h2 id="development">Development</h2><p>To build documentation, you&apos;ll need [ESDoc][] and plugins installed:</p>
<pre><code><code class="source-code prettyprint">yarn global add esdoc esdoc-ecmascript-proposal-plugin esdoc-standard-plugin</code>
</code></pre><p>Then, run:</p>
<pre><code><code class="source-code prettyprint">make</code>
</code></pre><p>This will also generate a <code>bin/saur</code> binstub so you can run CLI
commands.</p>
<p>Before submitting your code, make sure it&apos;s formatted:</p>
<pre><code><code class="source-code prettyprint">make fmt</code>
</code></pre></div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
